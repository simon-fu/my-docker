name: Run container

on:
  workflow_dispatch:
#   push:
#     branches: [ "main" ]
#   pull_request:
#     branches: [ "main" ]

env:
  CARGO_TERM_COLOR: always
  REPO_GIT_HASH: ${{ github.sha }}

jobs:
  build:

    runs-on: ubuntu-latest
    container: simonfucn/centos-7.9-rust:latest

    steps:
    - uses: actions/checkout@v3

    - name: install cmake
      run: |
        yum install -y epel-release
        yum install -y cmake3
        cmake3 --version
        alias cmake=cmake3
        cmake --version
      
    - name: display repo git hash
      run: echo REPO_GIT_HASH=$REPO_GIT_HASH

    - name: display rust version
      run: rustup --version

    - name: display clang version
      run: |
        ps -p $$
        echo "$SHELL"
        source scl_source enable llvm-toolset-7 || true
        clang --version
        echo REPO_GIT_HASH=$REPO_GIT_HASH

    - name: display dump_syms version
      run: dump_syms --version



